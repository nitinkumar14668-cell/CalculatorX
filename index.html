<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calculator Vault</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0b0b;
  --calc-dark:#262626;
  --calc-light:#bdbdbd;
  --orange:#f39c2f;
}
*{box-sizing:border-box;font-family:Inter,system-ui,Arial;}
body{margin:0;background:var(--bg);color:#fff;display:flex;align-items:center;justify-content:center;flex-direction:column;}

/* Banner Ad */
#bannerAd{width:100%; text-align:center; margin-bottom:10px;}
#bannerAd iframe{border:none;width:320px;height:50px;}

/* App Container */
.app{
  width:360px;
  max-width:95vw;
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 8px 25px rgba(0,0,0,.6);
}

/* Display */
.display{
  height:140px;
  padding:20px;
  display:flex;
  justify-content:flex-end;
  align-items:flex-end;
}
.display .value{
  font-size:70px;
  font-weight:300;
}

/* Calculator buttons */
.keys{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:15px;
  padding:15px;
}
.btn{
  height:70px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  cursor:pointer;
}
.btn.grey{background:#8b8b8b;color:#111;}
.btn.dark{background:var(--calc-dark);color:#fff;}
.btn.orange{background:var(--orange);color:#fff;}
.btn.zero{grid-column:1 / span 2;border-radius:40px;}

/* Vault screen */
.vault{
  display:none;
  padding:20px;
  background:linear-gradient(180deg,#090909,#141414);
  min-height:520px;
}
.search{
  background:#1f1f1f;
  padding:10px 15px;
  border-radius:10px;
  color:#bbb;
  margin-bottom:20px;
}
.icons-grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:18px;
}
.icon{
  text-align:center;
  cursor:pointer;
}
.icon img{
  width:56px;height:56px;
  border-radius:12px;
  margin-bottom:8px;
  object-fit:cover;
}
.icon .label{font-size:12px;color:#ddd}

/* Modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:20;}
.modal{background:#111;padding:20px;border-radius:12px;color:#eee;width:320px;}
.modal h3{margin:0 0 10px;font-size:18px}
.modal .actions{display:flex;justify-content:flex-end;gap:10px;margin-top:15px}
.btn-small{padding:8px 12px;border-radius:8px;cursor:pointer;}
.btn-cancel{background:#333;color:#fff;}
.btn-allow{background:var(--orange);color:#111;font-weight:600;}

.open-popup{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#111;padding:15px 25px;border-radius:12px;display:none;color:#fff;z-index:30;}

/* Password setup */
#setupBox{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.9);
  flex-direction:column;
  color:#fff;
  z-index:40;
}
#setupBox input{
  padding:10px;
  width:200px;
  border:none;
  border-radius:8px;
  font-size:16px;
  text-align:center;
  margin-top:10px;
}
#setupBox button{
  margin-top:15px;
  padding:10px 20px;
  border:none;
  border-radius:8px;
  background:var(--orange);
  color:#111;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>
<body>

<!-- Banner Ad -->
<div id="bannerAd">
  <iframe id="adFrame" src="about:blank"></iframe>
</div>

<div id="setupBox">
  <h3>Set Your Vault Password</h3>
  <input type="password" id="newPassword" placeholder="Enter new password">
  <button id="savePassword">Save Password</button>
</div>

<div class="app" id="mainApp">
  <!-- Calculator -->
  <div id="calculator">
    <div class="display"><div class="value" id="display">0</div></div>
    <div class="keys">
      <div class="btn grey" data-action="clear">C</div>
      <div class="btn grey" data-action="sign">+/-</div>
      <div class="btn grey" data-action="percent">%</div>
      <div class="btn orange" data-op="/">÷</div>

      <div class="btn dark" data-num="7">7</div>
      <div class="btn dark" data-num="8">8</div>
      <div class="btn dark" data-num="9">9</div>
      <div class="btn orange" data-op="*">×</div>

      <div class="btn dark" data-num="4">4</div>
      <div class="btn dark" data-num="5">5</div>
      <div class="btn dark" data-num="6">6</div>
      <div class="btn orange" data-op="-">−</div>

      <div class="btn dark" data-num="1">1</div>
      <div class="btn dark" data-num="2">2</div>
      <div class="btn dark" data-num="3">3</div>
      <div class="btn orange" data-op="+">+</div>

      <div class="btn dark zero" data-num="0">0</div>
      <div class="btn dark" data-num=".">.</div>
      <div class="btn orange" id="equals">=</div>
    </div>
  </div>

  <!-- Vault -->
  <div id="vault" class="vault">
    <div class="search">Search or enter url</div>
    <div class="icons-grid" id="iconsGrid"></div>
  </div>
</div>

<!-- Permission Modal -->
<div class="modal-backdrop" id="modalBackdrop">
  <div class="modal">
    <h3 id="modalTitle"></h3>
    <p id="modalText"></p>
    <div class="actions">
      <div class="btn-small btn-cancel" id="modalCancel">Cancel</div>
      <div class="btn-small btn-allow" id="modalAllow">Allow</div>
    </div>
  </div>
</div>

<div class="open-popup" id="openPopup">Opening...</div>

<script>
/* ===================== PASSWORD SETUP ===================== */
let PASSWORD = localStorage.getItem('vault_password');
const setupBox = document.getElementById('setupBox');
const mainApp = document.getElementById('mainApp');

if(PASSWORD){
  setupBox.style.display='none';
  mainApp.style.display='block';
}else{
  mainApp.style.display='none';
}

document.getElementById('savePassword').onclick=()=>{
  const val=document.getElementById('newPassword').value.trim();
  if(val.length<3)return alert("Password must be at least 3 digits!");
  localStorage.setItem('vault_password',val);
  PASSWORD=val;
  setupBox.style.display='none';
  mainApp.style.display='block';
  alert("Password saved successfully!");
};

/* ===================== CALCULATOR LOGIC ===================== */
const APPS=[
  {id:'apphide',label:'App Hide',icon:'https://cdn-icons-png.flaticon.com/512/3524/3524659.png'},
  {id:'photo',label:'Photo',icon:'https://cdn-icons-png.flaticon.com/512/685/685655.png'},
  {id:'video',label:'Video',icon:'https://cdn-icons-png.flaticon.com/512/727/727245.png'},
  {id:'browser',label:'Browser',icon:'https://cdn-icons-png.flaticon.com/512/1041/1041916.png'},
  {id:'downloads',label:'Downloads',icon:'https://cdn-icons-png.flaticon.com/512/724/724933.png'},
  {id:'camera',label:'Camera',icon:'https://cdn-icons-png.flaticon.com/512/2920/2920237.png'},
  {id:'gallery',label:'Gallery',icon:'https://cdn-icons-png.flaticon.com/512/709/709722.png'}
];

let current='0',shouldReset=false;
const display=document.getElementById('display');

function updateDisplay(){display.textContent=current;}
function inputDigit(d){if(shouldReset){current='0';shouldReset=false;}if(d==='.'&&current.includes('.'))return;if(current==='0'&&d!=='.')current=d;else current+=d;updateDisplay();}
function clearAll(){current='0';updateDisplay();}
function toggleSign(){if(current==='0')return;current=current.startsWith('-')?current.slice(1):'-'+current;updateDisplay();}
function percent(){current=String(parseFloat(current)/100);updateDisplay();}
function applyOp(op){if(/[+\-*/]$/.test(current))current=current.slice(0,-1)+op;else current+=op;updateDisplay();}
function flashError(){display.style.color='#ff6b6b';setTimeout(()=>display.style.color='#fff',500);}

document.querySelectorAll('.btn').forEach(b=>{
  if(b.dataset.num)b.onclick=()=>inputDigit(b.dataset.num);
  else if(b.dataset.op)b.onclick=()=>applyOp(b.dataset.op);
  else if(b.dataset.action){
    if(b.dataset.action==='clear')b.onclick=clearAll;
    if(b.dataset.action==='sign')b.onclick=toggleSign;
    if(b.dataset.action==='percent')b.onclick=percent;
  }
});
document.getElementById('equals').onclick=()=>{
  const text=current.trim();
  if(text===PASSWORD)return unlockVault();
  try{
    if(!/^[0-9+\-*/.() ]+$/.test(text))throw 0;
    let res=Function('"use strict";return('+text+')')();
    if(!isFinite(res))throw 0;
    current=String(res);shouldReset=true;updateDisplay();
  }catch(e){flashError();}
};

/* ===================== VAULT LOGIC ===================== */
const calc=document.getElementById('calculator');
const vault=document.getElementById('vault');
const iconsGrid=document.getElementById('iconsGrid');
let permissions={},pendingApp=null;

APPS.forEach(a=>{
  const d=document.createElement('div');
  d.className='icon';
  d.dataset.appid=a.id;
  d.innerHTML=`<img src="${a.icon}" alt="${a.label}"><div class="label">${a.label}</div>`;
  d.onclick=()=>onAppClick(a);
  iconsGrid.appendChild(d);
});

const modal=document.getElementById('modalBackdrop');
const title=document.getElementById('modalTitle');
const text=document.getElementById('modalText');
const cancel=document.getElementById('modalCancel');
const allow=document.getElementById('modalAllow');
const popup=document.getElementById('openPopup');

function unlockVault(){
  calc.style.display='none';
  vault.style.display='block';
  current='0';updateDisplay();
}
function onAppClick(app){
  if(permissions[app.id])return openApp(app);
  pendingApp=app;
  title.textContent=`${app.label} Permission`;
  text.textContent=`${app.label} wants permission to open. Allow?`;
  modal.style.display='flex';
}
cancel.onclick=()=>{modal.style.display='none';pendingApp=null;}
allow.onclick=()=>{
  if(pendingApp){
    permissions[pendingApp.id]=true;
    modal.style.display='none';
    openApp(pendingApp);
    pendingApp=null;
  }
};

/* ===================== ADMOB DEMO ===================== */
function loadBannerAd(){
  const iframe=document.getElementById('adFrame');
  iframe.src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-3546008790006961&slotname=1924982451&ad_type=text_image&format=320x50";
}

function showAppOpenAd(){
  console.log("App Open Ad demo shown");
}

function showRewardedAd(callback){
  alert("Rewarded Ad demo shown. Reward will be given after closing ad.");
  setTimeout(()=>{ callback(); }, 1500);
}

function openApp(app){
  if(app.id==='camera'){ 
    showRewardedAd(()=>{ 
      popup.textContent=`Opening ${app.label}...`;
      popup.style.display='block';
      setTimeout(()=>{popup.style.display='none'; alert(`${app.label} opened (demo)`);},700);
    });
  } else {
    popup.textContent=`Opening ${app.label}...`;
    popup.style.display='block';
    setTimeout(()=>{popup.style.display='none';alert(`${app.label} opened (demo)`);},700);
  }
}

/* Double-click vault background to return to calculator */
vault.ondblclick=()=>{vault.style.display='none';calc.style.display='block';}

/* Load Ads */
loadBannerAd();
showAppOpenAd();
updateDisplay();
</script>
</body>
</html>